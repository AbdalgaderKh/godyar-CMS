# سياسة الأمان

- لقد أزلنا ملف `.env` من المستودع وأضفناه إلى `.gitignore` لمنع تسريب كلمات المرور والمفاتيح.
- أنصح فورًا بتغيير/تدوير أي كلمات مرور أو مفاتيح قد تكون مخزنة في هذا المستودع في وقتٍ سابق.
- أضفنا فحصًا آليًا للأسرار عبر GitHub Actions (`.github/workflows/secret-scan.yml`) وأدرجناه أيضًا في CI الرئيسي لضمان فحص PRs.
- قمنا بتشديد سياسة Content-Security-Policy (CSP) لحرمان السكربتات inline من التنفيذ (`script-src 'self'`)، مع الإبقاء على `style-src 'unsafe-inline'` لأجل التوافق. قد يسبب هذا كسرًا لقطع واجهة تستخدم سكربتات inline؛ إن ظهر ذلك يمكنني مساعدتك في ترجيح النُهج إلى nonces أو نقل السكربتات لملفات منفصلة.
- لرفع مستوى الحماية: استخدم مدير أسرار خارجي (Vault, AWS Secrets Manager, Docker secrets) وفعّل فحوصات قبل الالتزام (pre-commit) مثل `gitleaks` أو `detect-secrets`.
- أضفت ملف `.githooks/pre-commit` كمثال لإعداد فحص محلي اختيارياً (قم بتشغيل `git config core.hooksPath .githooks` لتمكينه).
- أضفت سكربت تنفيذ الاختبارات داخل Docker (`scripts/run-tests-in-docker.sh`) لتسهيل تشغيل الاختبارات محليًا حتى لو كانت بيئة PHP في المضيف غير متوافقة.

إذا رغبت، يمكنني أيضاً:
- بحث تاريخ Git بحثًا عن أي أسرار حقيقية وأحضّر عملية لإزالتها نهائيًا (rebase/BFG) إذا وُجدت مفاتيح حقيقية — أحتاج موافقتك قبل المتابعة.
- إعداد المزيد من فحوصات الأمان (SAST) أو ضبط قواعد `psalm/phpstan` لمشروعك.
